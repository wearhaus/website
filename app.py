import urllib2
import json
import HTMLParser

from flask import Flask, render_template, request, jsonify, Response

app = Flask(__name__)

@app.route('/')
def main():
    html_parser = HTMLParser.HTMLParser()
    backup_featured = json.loads('{ "posts": [{ "url": "http://blog.wearhaus.com/2016/03/07/wearhaus-featured-artist-ruth-b/", "title": "Wearhaus Featured Artist: Ruth B", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b.jpg", "width": 1000, "height": 1000},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-768x768.jpg", "width": 768, "height": 768},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/03/ruth-b-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/02/29/1976/", "title": "Wearhaus Featured Artist: Cloud Cult", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/cloud-cult-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/02/11/wearhaus-celebrates-valentines-day/", "title": "Wearhaus Celebrates Valentine&#8217;s Day", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG.jpg", "width": 628, "height": 628},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG.jpg", "width": 628, "height": 628},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG.jpg", "width": 628, "height": 628},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG.jpg", "width": 628, "height": 628},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG.jpg", "width": 628, "height": 628},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/VDAY-BLOG-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/02/09/superbowl50/", "title": "Berkeley&#8217;s Cal Band on Performing with Coldplay and Beyonce at Super Bowl 50", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/PR_Blog6-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/02/09/national-pizza-day/", "title": "We Asked 5 Artists What their Favorite Pizza is for National Pizza Day", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/02/Pizza-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/02/01/wearhaus-featured-artist-ivy-levan/", "title": "Wearhaus Featured Artist: Ivy Levan", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy.jpg", "width": 1000, "height": 1000},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-768x768.jpg", "width": 768, "height": 768},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/ivy-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/01/27/bass-lounge-a-sensory-music-experience/", "title": "Bass Lounge: A Sensory Music Experience Recap", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/bass-lounge-2-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/01/18/wearhaus-featured-artist-the-brinks/", "title": "Wearhaus Featured Artist: The Brinks", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2016/01/The-Brinks-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/01/11/wearhaus-featured-artist-boyce-avenue/", "title": "Wearhaus Featured Artist: Boyce Avenue", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/12/Boyce-Avenue-150x150.jpg", "width": 150, "height": 150} }},{ "url": "http://blog.wearhaus.com/2016/01/05/wearhaus-featured-artist-avenue/", "title": "Wearhaus Featured Artist: Avenue", "thumbnail_size": "thumbnail", "thumbnail_images": {"full": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue.jpg", "width": 800, "height": 800},"thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-150x150.jpg", "width": 150, "height": 150},"medium": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-275x275.jpg", "width": 275, "height": 275},"medium_large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-768x768.jpg", "width": 768, "height": 768},"large": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue.jpg", "width": 800, "height": 800},"small": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-640x640.jpg", "width": 640, "height": 640},"recent": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-300x300.jpg", "width": 300, "height": 300},"custom-size": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-640x640.jpg", "width": 640, "height": 640},"wp_rp_thumbnail": { "url": "http://blog.wearhaus.com/wp-content/uploads/2015/01/Avenue-150x150.jpg", "width": 150, "height": 150} }} ]}')
    try: # check to see if we can fetch the latest blog posts
        featured_posts_url_response = urllib2.urlopen("http://blog.wearhaus.com/?json=get_recent_posts")
        try: # make sure the response is a true json formatted string
            featured_posts = json.loads(html_parser.unescape(featured_posts_url_response.read()))
        except ValueError, e:
            featured_posts = backup_featured
            pass
    except (urllib2.HTTPError, urllib2.URLError):
        featured_posts = backup_featured
        pass
    return render_template('index.html', featured_posts = featured_posts)

@app.route('/ourstory')
@app.route('/team')
def ourstory():
    return render_template('ourstory.html')

@app.route('/updater')
@app.route('/update')
def updater():
    return render_template('updater.html')

if __name__ == '__main__':
    app.debug = False
    app.run()
